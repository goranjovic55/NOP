{"type":"entity","name":"NOP.Project.Architecture","entityType":"System","observations":["Full-stack network operations platform","FastAPI backend + React frontend + Docker infrastructure","Multi-protocol remote access (SSH, VNC, RDP, FTP)","upd:2025-12-27,refs:4"]}
{"type":"entity","name":"NOP.Backend.FastAPI","entityType":"Service","observations":["REST API with async operations","JWT authentication and session management","PostgreSQL + Redis data layer","Scapy packet sniffing for passive discovery","upd:2025-12-27,refs:4"]}
{"type":"entity","name":"NOP.Frontend.React","entityType":"Service","observations":["TypeScript + Tailwind CSS","Zustand state management","Cyberpunk-themed UI design","upd:2025-12-27,refs:4"]}
{"type":"entity","name":"Frontend.Assets.ServiceDiscovery","entityType":"Feature","observations":["Service column displays discovered services (SSH, RDP, VNC, TELNET, WEB, FTP)","Service badges based on open ports from scans","Visual indicators for scanned vs unscanned hosts","Only discovered services shown in connection options","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Frontend.Assets.ConnectionFiltering","entityType":"Feature","observations":["Connect button only shows discovered services","Service detection based on port mapping (22=SSH, 3389=RDP, 5900=VNC, etc)","No service option shown for unscanned hosts","Enhanced AssetDetailsSidebar with service filtering","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Frontend.Assets.PassiveDiscovery","entityType":"Feature","observations":["Toggle button in Assets page header for passive discovery","Green PASSIVE ON indicator when enabled, gray PASSIVE OFF when disabled","Automatically imports passively discovered hosts every 30 seconds","Settings persist to localStorage","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Assets.DiscoveryMethodColumn","entityType":"Feature","observations":["Discovery column shows how each host was found","PASSIVE (green with glow) - discovered from network traffic","ARP (blue) - discovered via ARP scan","PING (purple) - discovered via ping sweep","COMPREHENSIVE (red with glow) - discovered via detailed nmap scan","Visual distinction between discovery techniques","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Services.PassiveDiscovery","entityType":"Service","observations":["Scapy-based packet sniffing on container network interface","Tracks discovered hosts from IP/TCP/UDP/ICMP traffic","Records IP addresses, MAC addresses, protocols, first/last seen timestamps","Filters out broadcast and multicast addresses","Creates assets with status=UNKNOWN (not verified connectivity)","Sets discovery_method=passive for traffic-based discoveries","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Services.SnifferService","entityType":"Service","observations":["Background packet capture on eth0 interface","Maintains discovered_hosts dictionary with metadata","Provides get_discovered_hosts() and clear_discovered_hosts() methods","Non-intrusive host detection from network communications","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Discovery.MethodTracking","entityType":"Feature","observations":["Discovery method properly tracked for each scan type","ARP scans set discovery_method=arp","Ping scans set discovery_method=ping","Comprehensive scans set discovery_method=comprehensive","Passive discoveries set discovery_method=passive","Discovery method updates from less to more detailed techniques","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Assets.StatusHandling","entityType":"Feature","observations":["Passive discoveries create assets with status=UNKNOWN","Active scans (ARP/ping/nmap) set status=ONLINE or OFFLINE","Status distinguishes verified connectivity from observed traffic","UNKNOWN status indicates host seen in traffic but not actively probed","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Scans.HostSelection","entityType":"Feature","observations":["Default Host Selection tab always visible as first tab","Grid layout with detailed host cards showing IP, hostname, OS, MAC, vendor","Card-based multi-select interface with checkboxes","Filter by All/Scanned/Unscanned hosts with counts","Visual distinction between scanned (green badge) and unscanned hosts","REPLACED by persistent dashboard tab design","upd:2025-12-27,refs:3"]}
{"type":"entity","name":"Frontend.Scans.MultiHostScanning","entityType":"Feature","observations":["Select multiple hosts via card clicks","Start button creates individual scan tabs for each selected host","Tab navigation between host selection and individual scans","Host selection tab refreshes every 10 seconds","Real-time host status and service updates","Enhanced with array support in ScanTab interface","Sequential execution with per-host progress logging","upd:2025-12-27,refs:3"]}
{"type":"entity","name":"Frontend.Scans.DashboardTab","entityType":"Feature","observations":["Persistent dashboard tab with home icon (âŒ‚) always visible","Cannot be closed - permanent navigation point to scan dashboard","Shows unscanned asset count in subtitle","Purple highlight when active, color-coded tab states","One-click asset card selection without checkboxes","Red border glow on selected assets for visual feedback","Manual IP input always accessible above tabs","Quick '+' button for adding manual scans","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Scans.MultiHostSupport","entityType":"Feature","observations":["ScanTab interface extended with optional ips[] array field","addTab() accepts string | string[] for single or multi-host scans","Multi-host tabs display 'Multi-host (N)' with truncated IP preview","Sequential scanning with individual host progress logging","Automatic tab switching when creating new scans from dashboard","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Scans.ImprovedUX","entityType":"Feature","observations":["Removed duplicate manual IP input from dashboard (present above tabs)","Asset cards toggle selection on click anywhere on card","No checkboxes - cleaner card-based interface","Click to select, click again to deselect","Selected state persists until user changes it","Integrated better top bar design from copilot/update-scan-page-default-view branch","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Layout.DiscoveryIndicator","entityType":"Feature","observations":["Blue pulsing dot on Assets menu item during active discovery","Similar to red dot for Scans and green badge for Access Hub","Real-time indicator updates via discoveryStore","Visual consistency across all navigation indicators","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Store.DiscoveryStore","entityType":"State","observations":["Zustand store managing global discovery state","isDiscovering boolean flag","setIsDiscovering action to update state","Integrated with Assets page scan lifecycle","Triggers sidebar indicator updates in Layout","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Scans.CardLayout","entityType":"UI","observations":["Responsive grid: 1-4 columns based on screen size","Cards show status badges, IP, hostname, system details","Scanned hosts display discovered service badges","Purple glow effect on selected cards","Last seen timestamp on each card","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Frontend.AccessHub.VaultFeature","entityType":"Feature","observations":["Password-protected credential vault with group management","Three sorting modes: Recent, Frequent, Name","Supports adding/removing credentials from vault","Cyberpunk-styled UI with green accents and geometric symbols","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Frontend.AccessHub.ConnectionManagement","entityType":"Feature","observations":["Resizable connection area with drag handle","Fullscreen mode for active connections","Password-protected quick connect from vault","Tab-based connection interface","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Frontend.AccessHub.GroupManagement","entityType":"Feature","observations":["User-defined groups for organizing hosts","Group selector dropdown with custom styling","Add new groups via modal interface","Filter credentials by selected group","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Backend.Services.AssetService","entityType":"Service","observations":["Network asset discovery and management","NMAP integration for scanning","Asset metadata and tracking","Port-based service detection","upd:2025-12-27,refs:3"]}
{"type":"entity","name":"Backend.Services.GuacamoleService","entityType":"Service","observations":["Remote desktop protocol handling","VNC, RDP, SSH connection management","Apache Guacamole integration","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Backend.Core.Security","entityType":"Module","observations":["JWT token generation and validation","Password hashing with bcrypt","Role-based access control","upd:2025-12-27,refs:2"]}
{"type":"codegraph","name":"Assets.tsx","nodeType":"component","dependencies":["assetService","AssetDetailsSidebar","useScanStore","useAccessStore","useDiscoveryStore","ScanSettingsModal"],"dependents":["Layout"]}
{"type":"codegraph","name":"Scans.tsx","nodeType":"component","dependencies":["assetService","useScanStore","useAuthStore"],"dependents":["Layout"]}
{"type":"codegraph","name":"Layout.tsx","nodeType":"component","dependencies":["useAuthStore","useScanStore","useAccessStore","useDiscoveryStore"],"dependents":["App"]}
{"type":"codegraph","name":"ScanStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["Scans.tsx","Assets.tsx"]}
{"type":"codegraph","name":"DiscoveryStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["Assets.tsx","Layout.tsx"]}
{"type":"codegraph","name":"AssetDetailsSidebar.tsx","nodeType":"component","dependencies":["Asset","useScanStore","useAccessStore"],"dependents":["Assets.tsx"]}
{"type":"codegraph","name":"AccessHub.tsx","nodeType":"component","dependencies":["useAccessStore","ProtocolConnection"],"dependents":["Layout"]}
{"type":"codegraph","name":"AssetService.py","nodeType":"service","dependencies":["Database","NMAP"],"dependents":["DiscoveryEndpoint"]}
{"type":"codegraph","name":"SnifferService.py","nodeType":"service","dependencies":["Scapy","Threading","IPAddress"],"dependents":["DiscoveryEndpoint"]}
{"type":"codegraph","name":"DiscoveryService.py","nodeType":"service","dependencies":["Database","Scanner","Asset"],"dependents":["DiscoveryEndpoint"]}
{"type":"codegraph","name":"GuacamoleService.py","nodeType":"service","dependencies":["HTTPClient","ConnectionPool"],"dependents":["AccessEndpoint"]}
{"type":"relation","from":"Assets.tsx","to":"ServiceDiscovery","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Assets.tsx","to":"PassiveDiscovery","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Assets.tsx","to":"DiscoveryMethodColumn","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Assets.tsx","to":"DiscoveryStore","relationType":"UPDATES"}
{"type":"relation","from":"Scans.tsx","to":"HostSelection","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Scans.tsx","to":"MultiHostScanning","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Scans.tsx","to":"DashboardTab","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Scans.tsx","to":"MultiHostSupport","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Scans.tsx","to":"ImprovedUX","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Layout.tsx","to":"DiscoveryIndicator","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Layout.tsx","to":"DiscoveryStore","relationType":"CONSUMES"}
{"type":"relation","from":"AssetDetailsSidebar","to":"ConnectionFiltering","relationType":"IMPLEMENTS"}
{"type":"relation","from":"AccessHub","to":"VaultFeature","relationType":"IMPLEMENTS"}
{"type":"relation","from":"VaultFeature","to":"GroupManagement","relationType":"USES"}
{"type":"relation","from":"Backend.FastAPI","to":"Backend.Services","relationType":"DEPENDS_ON"}
{"type":"relation","from":"Frontend.React","to":"Backend.FastAPI","relationType":"CONSUMES"}
{"type":"relation","from":"SnifferService","to":"PassiveDiscovery","relationType":"ENABLES"}
{"type":"relation","from":"DiscoveryService","to":"MethodTracking","relationType":"IMPLEMENTS"}
{"type":"relation","from":"PassiveDiscovery","to":"StatusHandling","relationType":"USES"}
{"type":"relation","from":"DiscoveryStore","to":"DiscoveryIndicator","relationType":"ENABLES"}

