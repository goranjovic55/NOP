{"type":"entity","name":"NOP.Project.Architecture","entityType":"System","observations":["Full-stack network operations platform","FastAPI backend + React frontend + Docker infrastructure","Multi-protocol remote access (SSH, VNC, RDP, FTP)","Host management with system monitoring, terminal, filesystem, desktop","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"NOP.Backend.FastAPI","entityType":"Service","observations":["REST API with async operations","JWT authentication and session management","PostgreSQL + Redis data layer","WebSocket terminal with PTY support","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"NOP.Frontend.React","entityType":"Service","observations":["TypeScript + Tailwind CSS","Zustand state management","Cyberpunk-themed UI with geometric icons","xterm.js terminal integration","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"Frontend.Traffic.AdvancedPing","entityType":"Feature","observations":["Multi-protocol ping support: ICMP, TCP, UDP, HTTP, DNS","hping3 integration for crafted packets with routing info","Asset dropdown with live filtering by IP/hostname","Online/offline status color coding (green/gray)","Protocol-specific tools: ping, hping3, curl, dig","Raw terminal output display for detailed analysis","Vertical layout: protocols left side, output right side","Grid-based protocol buttons (5 columns) with full width coverage","Verbose protocol descriptions with tool details","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"Frontend.Scans.AssetSelection","entityType":"Feature","observations":["Asset dropdown with auto-filtering by IP/hostname","Online/offline status indicators with color coding","CIDR notation support for subnet scanning (/24, /32)","Filter controls: status (all/online/offline) and IP search","Auto-complete from asset inventory when typing target","Multi-host scan capability with batch selection","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Common.FilterPersistence","entityType":"Feature","observations":["localStorage-based filter state persistence","Assets page: statusFilter and subnetFilter persistence","Scans page: statusFilter and ipFilter persistence","Traffic page: activeTab and packet filter persistence","Filter state restored on page reload/navigation","Namespace: nop_*_filter for each page context","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Traffic.PacketCapture","entityType":"Feature","observations":["Real-time network packet sniffing via WebSocket","Interface selection with activity sparklines","BPF filter support for targeted capture","Vertical layout: packet list left, flows right, inspector sidebar","Full packet dissection: Ethernet, IP, TCP, UDP, ICMP, ARP layers","Collapsible layer sections with field-level detail","Payload preview with ASCII representation","PCAP export functionality","Filter state persisted to localStorage","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"Backend.Services.SnifferService","entityType":"Service","observations":["Scapy-based packet capture on specified interfaces","Full protocol dissection for Ethernet, ARP, IP, TCP, UDP, ICMP","TCP flags decoded to readable names (SYN, ACK, PSH, etc.)","ICMP types mapped to human-readable names","Payload extraction with ASCII preview (first 64 bytes)","WebSocket streaming of captured packets","Flow tracking between source and destination","upd:2025-12-28,refs:2"]}
{"type":"entity","name":"Backend.Services.PingService","entityType":"Service","observations":["Advanced multi-protocol ping implementation","ICMP: Standard ping with RTT statistics","TCP: hping3 SYN packets with verbose routing data","UDP: hping3 UDP packets with routing information","HTTP/HTTPS: curl-based connectivity testing","DNS: dig queries to test DNS server responsiveness","Socket-based fallback when hping3 unavailable","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.AccessHub.VaultFeature","entityType":"Feature","observations":["Password-protected credential vault with group management","Three sorting modes: Recent, Frequent, Name","Supports adding/removing credentials from vault","Cyberpunk-styled UI with green accents and geometric symbols","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.AccessHub.ConnectionManagement","entityType":"Feature","observations":["Resizable connection area with drag handle","Fullscreen mode for active connections","Password-protected quick connect from vault","Tab-based connection interface","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.AccessHub.GroupManagement","entityType":"Feature","observations":["User-defined groups for organizing hosts","Group selector dropdown with custom styling","Add new groups via modal interface","Filter credentials by selected group","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Services.AssetService","entityType":"Service","observations":["Network asset discovery and management","NMAP integration for scanning","Asset metadata and tracking","Online/offline status monitoring","Provides asset list endpoint with filtering","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Services.GuacamoleService","entityType":"Service","observations":["Remote desktop protocol handling","VNC, RDP, SSH connection management","Apache Guacamole integration","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Core.Security","entityType":"Module","observations":["JWT token generation and validation","Password hashing with bcrypt","Role-based access control","Fixed: Removed problematic db dependency in get_current_user","upd:2025-12-27,refs:2"]}
{"type":"entity","name":"Backend.Docker.Tools","entityType":"Infrastructure","observations":["hping3 for TCP/UDP crafted packets","traceroute and tcptraceroute for path analysis","dig for DNS queries","nmap for network scanning","scapy for packet manipulation","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Host.SystemMetrics","entityType":"Feature","observations":["Real-time CPU, memory, disk, network monitoring","Process table with top processes by CPU usage","Cyberpunk-styled progress bars and data displays","psutil integration for system metrics","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Host.Terminal","entityType":"Feature","observations":["WebSocket-based PTY terminal","xterm.js with FitAddon for responsive sizing","Cyberpunk color theme with neon accents","Resize support with TIOCSWINSZ","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Host.DataVault","entityType":"Feature","observations":["Dual-pane file browser (Target Node + Operator Storage)","Resumeable file uploads with chunked transfer","File System Access API for direct directory linking","Drag-and-drop file selection","Pause/resume upload controls","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Host.Desktop","entityType":"Feature","observations":["VNC and RDP remote desktop connections via Guacamole","Simplified UI with VNC/RDP toggle buttons connecting to localhost","Guacamole WebSocket tunnel with instruction buffering to prevent incomplete instructions","Internal connectionStatus state for reliable display attachment","useLayoutEffect for proper display DOM attachment timing","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"Backend.Host.Endpoints","entityType":"Module","observations":["System info and metrics endpoints","Filesystem browse, read, write, delete operations","File upload (base64) and download endpoints","WebSocket terminal with PTY fork and ioctl","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Guacamole.Tunnel","entityType":"Service","observations":["WebSocket tunnel between browser and guacd","Localhost remapping to container names via VNC_HOST/RDP_HOST env vars","String-based receive buffer for proper instruction concatenation","Instruction buffering to prevent incomplete Guacamole protocol messages","Guacamole subprotocol handling for WebSocket handshake","Detailed connection logging for debugging","upd:2025-12-28,refs:3"]}
{"type":"entity","name":"Backend.Services.DiscoveryService","entityType":"Service","observations":["Processes scan results and updates asset database","Always updates discovery_method to reflect last scan type used","Updates hostname, MAC, vendor from scan results","Handles both NMAP and ARP scan types","upd:2025-12-28,refs:2"]}
{"type":"entity","name":"Pattern.Codespaces.WebSocket","entityType":"Pattern","observations":["GitHub Codespaces requires direct WebSocket to backend port (12001) not through frontend proxy","Replace port in URL: window.location.host.replace('-12000.', '-12001.')","Frontend proxy corrupts binary WebSocket data","Use window.location for dynamic URL construction","upd:2025-12-28,refs:1"]}
{"type":"codegraph","name":"SnifferService.py","nodeType":"service","dependencies":["scapy","Ether","IP","TCP","UDP","ICMP","ARP","Raw"],"dependents":["TrafficEndpoint"]}
{"type":"codegraph","name":"Traffic.tsx","nodeType":"component","dependencies":["useAuthStore","PingService","AssetService"],"dependents":["Layout"]}
{"type":"codegraph","name":"Scans.tsx","nodeType":"component","dependencies":["useScanStore","useAuthStore","assetService"],"dependents":["Layout"]}
{"type":"codegraph","name":"Assets.tsx","nodeType":"component","dependencies":["useAuthStore","assetService"],"dependents":["Layout"]}
{"type":"codegraph","name":"PingService.py","nodeType":"service","dependencies":["asyncio","subprocess","hping3","dig"],"dependents":["TrafficEndpoint"]}
{"type":"codegraph","name":"AccessHub.tsx","nodeType":"component","dependencies":["useAccessStore","ProtocolConnection"],"dependents":["Layout"]}
{"type":"codegraph","name":"Host.tsx","nodeType":"component","dependencies":["hostService","useAuthStore","useAccessStore","Terminal","FitAddon","ProtocolConnection"],"dependents":["Layout"]}
{"type":"codegraph","name":"host.py","nodeType":"endpoint","dependencies":["psutil","pty","security"],"dependents":["router"]}
{"type":"codegraph","name":"AssetService.py","nodeType":"service","dependencies":["Database","NMAP"],"dependents":["DiscoveryEndpoint","TrafficEndpoint"]}
{"type":"codegraph","name":"GuacamoleService.py","nodeType":"service","dependencies":["HTTPClient","ConnectionPool"],"dependents":["AccessEndpoint"]}
{"type":"relation","from":"Traffic.AdvancedPing","to":"PingService","relationType":"CONSUMES"}
{"type":"relation","from":"PingService","to":"Docker.Tools","relationType":"DEPENDS_ON"}
{"type":"relation","from":"Traffic.AdvancedPing","to":"AssetService","relationType":"USES"}
{"type":"relation","from":"Scans.AssetSelection","to":"AssetService","relationType":"USES"}
{"type":"relation","from":"Scans.AssetSelection","to":"FilterPersistence","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Traffic.PacketCapture","to":"FilterPersistence","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Assets.Page","to":"FilterPersistence","relationType":"IMPLEMENTS"}
{"type":"relation","from":"AccessHub","to":"VaultFeature","relationType":"IMPLEMENTS"}
{"type":"relation","from":"VaultFeature","to":"GroupManagement","relationType":"USES"}
{"type":"relation","from":"Backend.FastAPI","to":"Backend.Services","relationType":"DEPENDS_ON"}
{"type":"relation","from":"Frontend.React","to":"Backend.FastAPI","relationType":"CONSUMES"}
{"type":"relation","from":"Host.tsx","to":"Backend.Host.Endpoints","relationType":"CONSUMES"}
{"type":"relation","from":"Host.tsx","to":"Terminal","relationType":"USES"}
{"type":"relation","from":"Host.tsx","to":"DataVault","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Traffic.PacketCapture","to":"SnifferService","relationType":"CONSUMES"}
{"type":"relation","from":"SnifferService","to":"Scapy","relationType":"USES"}
{"type":"entity","name":"Frontend.Exploit.Page","entityType":"Feature","observations":["Vulnerability scanning with multi-database support (CVE, ExploitDB, Metasploit, Vulners, PacketStorm)","Exploit builder with payload generation (reverse shell, bind shell, meterpreter, web shell)","Interactive shell console with session management","Target filtering: all, scanned, unscanned, vulnerable","Asset scanning with vulnerability detection","Filter and database selection persistence via localStorage","Vulnerable targets tracked and persisted across sessions","Cyberpunk UI with geometric icons (◆/◇)","Detail panels at 40% width","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"Frontend.Store.ExploitStore","entityType":"State","observations":["Zustand-based global state for shell sessions","Tracks active exploit connections with status (connecting, connected, disconnected, failed)","Session management: add, remove, setActive, updateStatus","Command execution tracking per session","Active session count and indicators for UI","Integrates with Layout for navigation badge display","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"Frontend.Layout.ExploitIndicator","entityType":"Feature","observations":["Red badge on Exploit navigation item showing active connection count","Uses exploitStore.getActiveSessionCount() for real-time updates","Matches pattern from Access Hub (green badge) and Scans (red pulse)","Cyberpunk geometric icon ◆/◇ instead of emoji","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"Frontend.Exploit.VulnerabilityScanning","entityType":"Feature","observations":["Multi-database selection: CVE, ExploitDB, Metasploit, Vulners, PacketStorm","Scan results show CVE ID, CVSS score, severity, affected service/port","Details button opens 40% width side panel","Build button opens exploit builder side panel","No click-through on scan results (button-only interaction)","Scanned vulnerable assets tracked in Set and persisted to localStorage","Vulnerable filter shows only scanned targets with actual CVE findings","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"Frontend.Exploit.FilterPersistence","entityType":"Feature","observations":["Asset filter (all/scanned/unscanned/vulnerable) persisted as exploit_assetFilter","IP filter text persisted as exploit_ipFilter","Selected databases array persisted as exploit_selectedDatabases","Scanned vulnerable IPs Set persisted as exploit_scannedVulnerable (JSON array)","All restored from localStorage on component mount","Follows project pattern for filter persistence","upd:2025-12-29,refs:1"]}
{"type":"codegraph","name":"Exploit.tsx","nodeType":"component","dependencies":["useExploitStore","useAuthStore","assetService"],"dependents":["Layout"]}
{"type":"codegraph","name":"exploitStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["Exploit","Layout"]}
{"type":"codegraph","name":"Layout.tsx","nodeType":"component","dependencies":["useExploitStore","useScanStore","useAccessStore","useDiscoveryStore"],"dependents":["App"]}
{"type":"relation","from":"Exploit.Page","to":"ExploitStore","relationType":"USES"}
{"type":"relation","from":"Layout","to":"ExploitStore","relationType":"CONSUMES"}
{"type":"relation","from":"Exploit.FilterPersistence","to":"localStorage","relationType":"PERSISTS_TO"}
{"type":"relation","from":"Exploit.VulnerabilityScanning","to":"FilterPersistence","relationType":"IMPLEMENTS"}
{"type":"relation","from":"DiscoveryService","to":"AssetService","relationType":"UPDATES"}
{"type":"entity","name":"NOP.AgentFramework","entityType":"System","observations":["Multi-agent orchestration framework using GitHub official custom agent format","DevTeam orchestrator coordinates specialist agents","Four specialist agents: Architect, Developer, Reviewer, Researcher","Structured delegation via #runSubagent tool","Workflow templates for common development tasks","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"AgentFramework.DevTeam","entityType":"Agent","observations":["Orchestrator agent for complex multi-step tasks","Analyzes requests and breaks into steps","Delegates to specialists using #runSubagent tool","Integrates results from multiple specialists","Follows sequential or parallel delegation patterns","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"AgentFramework.Architect","entityType":"Agent","observations":["Design and architecture specialist","Technology choice evaluation","Component structure definition","Trade-off analysis and documentation","Design decision recording","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"AgentFramework.Developer","entityType":"Agent","observations":["Implementation specialist","Feature development and bug fixes","Code refactoring and optimization","Follows best practices and project patterns","Test writing and debugging","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"AgentFramework.Reviewer","entityType":"Agent","observations":["Quality assurance specialist","Code review and validation","Test execution and coverage analysis","Security and bug detection","Standards compliance checking","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"AgentFramework.Researcher","entityType":"Agent","observations":["Investigation and analysis specialist","Codebase exploration and pattern discovery","Dependency analysis and documentation","Issue identification and opportunity detection","Knowledge base updates","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"AgentFramework.Structure","entityType":"Infrastructure","observations":[".github/agents/ contains 5 agent definition files (.agent.md format)",".github/AGENTS_README.md documents agent usage and patterns",".github/DEMO_WORKFLOW.md provides comprehensive workflow examples",".github/copilot-instructions.md defines multi-agent architecture",".github/instructions/ contains framework documentation modules","Legacy chatmodes removed - using official GitHub agent format only","upd:2025-12-28,refs:1"]}
{"type":"codegraph","name":"DevTeam.agent.md","nodeType":"agent","dependencies":["runSubagent","Architect","Developer","Reviewer","Researcher"],"dependents":["UserRequests"]}
{"type":"codegraph","name":"Architect.agent.md","nodeType":"agent","dependencies":["DesignPatterns","TechnologyEvaluation"],"dependents":["DevTeam"]}
{"type":"codegraph","name":"Developer.agent.md","nodeType":"agent","dependencies":["CodeGeneration","Testing","Debugging"],"dependents":["DevTeam"]}
{"type":"codegraph","name":"Reviewer.agent.md","nodeType":"agent","dependencies":["QualityChecks","TestExecution","SecurityValidation"],"dependents":["DevTeam"]}
{"type":"codegraph","name":"Researcher.agent.md","nodeType":"agent","dependencies":["CodebaseAnalysis","PatternDiscovery","Documentation"],"dependents":["DevTeam"]}
{"type":"relation","from":"DevTeam","to":"Architect","relationType":"DELEGATES_TO"}
{"type":"relation","from":"DevTeam","to":"Developer","relationType":"DELEGATES_TO"}
{"type":"relation","from":"DevTeam","to":"Reviewer","relationType":"DELEGATES_TO"}
{"type":"relation","from":"DevTeam","to":"Researcher","relationType":"DELEGATES_TO"}
{"type":"relation","from":"AgentFramework","to":"project_knowledge.json","relationType":"USES"}
{"type":"relation","from":"AgentFramework","to":"global_knowledge.json","relationType":"USES"}
