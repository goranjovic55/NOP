{"type":"entity","name":"NOP.Project.Architecture","entityType":"System","observations":["Full-stack network operations platform","FastAPI backend + React frontend + Docker infrastructure","Multi-protocol remote access (SSH, VNC, RDP, FTP)","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"NOP.Backend.FastAPI","entityType":"Service","observations":["REST API with async operations","JWT authentication and session management","PostgreSQL + Redis data layer","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"NOP.Frontend.React","entityType":"Service","observations":["TypeScript + Tailwind CSS","Zustand state management","Cyberpunk-themed UI design","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"AKIS.Monitor.VSCodeExtension","entityType":"Tool","observations":["Live session monitoring in VS Code activity bar","Stack-based action display (newest actions on top)","Auto-expand on new actions when collapsed","Toggleable auto-scroll to newest action","Activity-based status: active until COMPLETE emission, idle indicator after 30s","Enhanced status command returns workflow mapping and context","Real-time updates every 2 seconds","upd:2026-01-02"]}
{"type":"entity","name":"AKIS.SessionTracker","entityType":"Service","observations":["CLI tool for AKIS session state management (node .github/scripts/session-tracker.js)","Multi-session SSOT in .akis-sessions.json and .akis-session.json","Sessions stay active until explicit COMPLETE emission","Activity timeout (30s) for UI idle indicator only, does not change session status","Status command returns: workflow mapping, phase progress, context stats, recent actions","Stack-based action tracking with chronological IDs","Auto-expand logic on new actions via sessionStorage comparison","upd:2026-01-02"]}
{"type":"entity","name":"Frontend.Scans.VulnerabilityScanWorkflow","entityType":"feature","observations":["Real NVD CVE lookups replaced mock data (removed lines 341-431, ~135 lines)","Workflow: Port Scan → Version Detection (nmap -sV) → CVE Lookup (NVD API) → Exploit Filtering","Version Detection: POST /api/v1/scans/{id}/version-detection with host + ports","CVE Lookup: POST /api/v1/vulnerabilities/lookup-cve with product + version","Exploit Filtering: Only shows CVEs with available exploit modules","Product mapping: nmap names → CPE identifiers (apache httpd → apache/http_server)","upd:2026-01-01"]}
{"type":"entity","name":"Backend.Services.CVELookupService","entityType":"service","observations":["NVD API v2.0 integration for real CVE lookups","Rate limiting: 5 req/30s without API key, 50 req/30s with key","7-day PostgreSQL cache reduces API calls by 80%","Product mapping dictionary: nmap output → CPE vendor/product names","CPE format: cpe:2.3:a:vendor:product:version:*:*:*:*:*:*:*","Input sanitization prevents CPE/product/version injection","upd:2026-01-01"]}
{"type":"entity","name":"Backend.Services.VersionDetectionService","entityType":"service","observations":["nmap -sV integration for service version detection","Extracts CPE identifiers from nmap XML output","Updates Asset.services JSON field with version data","Fixed database query: cast(Asset.ip_address, Text) for inet type comparison","Product mapping applied before CPE generation","upd:2026-01-01"]}
{"type":"entity","name":"Backend.Services.ExploitMatchService","entityType":"service","observations":["Maps CVEs to exploit modules (Metasploit, Exploit-DB)","Query database first, fallback to static mappings file","Static mappings location: backend/app/data/cve_to_exploits.json (not yet created)","Filters vulnerability scan results to exploitable-only CVEs","upd:2026-01-01"]}
{"type":"entity","name":"Frontend.AccessHub.VaultFeature","entityType":"Feature","observations":["Password-protected credential vault with group management","Three sorting modes: Recent, Frequent, Name","Supports adding/removing credentials from vault","Cyberpunk-styled UI with green accents and geometric symbols","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.AccessHub.ConnectionManagement","entityType":"Feature","observations":["Resizable connection area with drag handle","Fullscreen mode for active connections","Password-protected quick connect from vault","Tab-based connection interface","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.AccessHub.GroupManagement","entityType":"Feature","observations":["User-defined groups for organizing hosts","Group selector dropdown with custom styling","Add new groups via modal interface","Filter credentials by selected group","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Frontend.Traffic.PacketCrafting","entityType":"Feature","observations":["Advanced packet crafting interface with protocol selection (TCP/UDP/ICMP/ARP/IP)","Left pane: basic parameters (protocol, IPs, ports, flags, send control)","Right pane: terminal-style output with trace and response","Sliding structure panel (600px) for editing all packet fields by layer","Hex/ASCII payload editor with synchronized editing","IP dropdown with online assets highlighted green","Port dropdown with common services","Cyber-themed custom checkboxes for TCP flags","Embedded as tab in Traffic page (no header/back button)","Edit Structure button in Send Control section","upd:2025-12-28,refs:2"]}
{"type":"entity","name":"Frontend.Traffic.PacketStructure","entityType":"Feature","observations":["Layer 2 (Ethernet): Editable MAC addresses, fixed EtherType","Layer 3 (IPv4): Editable TOS/ID/Flags/TTL, fixed Version/IHL/FragOffset, auto checksum","Layer 4 (TCP): Editable ports/seq/ack/window/flags/urgent, fixed DataOffset/Reserved, auto checksum","Layer 4 (UDP): Editable ports, auto length/checksum","Layer 4 (ICMP): Editable type/code, auto checksum","Payload hex editor with Tab to add byte, Backspace to remove","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"Frontend.Traffic.PacketInspector","entityType":"Feature","observations":["600px wide sliding panel from right","Full protocol dissection: Ethernet, ARP, IP, TCP, UDP, ICMP, DNS, HTTP, TLS","Application layer detection based on ports (SSH, FTP, MySQL, RDP, etc)","Hex dump with ASCII preview","Payload preview with hex and ASCII","Text-xs fonts for consistency","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"Frontend.Traffic.Sorting","entityType":"Feature","observations":["Clickable column headers for sorting packets","Supports Time, Source, Destination, Protocol, Length columns","Ascending/descending toggle with visual indicators","SortIcon component shows ↕ (inactive), ↑ (asc), ↓ (desc)","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"Frontend.Traffic.FlowFiltering","entityType":"Feature","observations":["Click on Active Flow to filter packet list","Filtered count shows 'N / total Packets'","Clear Filter button to reset","Highlights selected flow in purple","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"Backend.Services.SnifferService.Dissector","entityType":"Feature","observations":["Full protocol dissection using Scapy","Supports Ethernet, ARP, IPv4, TCP, UDP, ICMP layers","DNS layer with query parsing","HTTP layer with request/response detection","TLS/SSL layer detection","Application layer detection via port mapping (30+ protocols)","Payload extraction with hex and ASCII preview","upd:2025-12-28,refs:1"]}
{"type":"entity","name":"Backend.Services.SnifferService.PassiveDiscovery","entityType":"Feature","observations":["Tracks IP addresses from network traffic for passive asset discovery","Configurable source-only mode prevents phantom hosts (default: enabled)","Source IP validation filters invalid IPs (0.0.0.0, broadcast, multicast, link-local)","Granular packet filtering: unicast, multicast, broadcast (configurable per type)","Maintains discovered_hosts dictionary with first/last seen timestamps and MAC addresses","Filters prevent false positives from ARP scans, stale connections, and network probes","Interface configurable via Settings with auto-detection dropdown","upd:2025-12-29"]}
{"type":"entity","name":"Backend.Services.AssetService","entityType":"Service","observations":["Network asset discovery and management","NMAP integration for scanning","Asset metadata and tracking","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Services.GuacamoleService","entityType":"Service","observations":["Remote desktop protocol handling","VNC, RDP, SSH connection management","Apache Guacamole integration","upd:2025-12-27,refs:1"]}
{"type":"entity","name":"Backend.Core.Security","entityType":"Module","observations":["JWT token generation and validation","Password hashing with bcrypt","Role-based access control","upd:2025-12-27,refs:1"]}
{"type":"codegraph","name":"AccessHub.tsx","nodeType":"component","dependencies":["useAccessStore","ProtocolConnection"],"dependents":["Layout"]}
{"type":"codegraph","name":"PacketCrafting.tsx","nodeType":"component","dependencies":["useAuthStore","assetService"],"dependents":["Traffic.tsx"]}
{"type":"codegraph","name":"Traffic.tsx","nodeType":"page","dependencies":["PacketCrafting","assetService"],"dependents":["Layout"]}
{"type":"codegraph","name":"AssetService.py","nodeType":"service","dependencies":["Database","NMAP"],"dependents":["DiscoveryEndpoint"]}
{"type":"codegraph","name":"GuacamoleService.py","nodeType":"service","dependencies":["HTTPClient","ConnectionPool"],"dependents":["AccessEndpoint"]}
{"type":"relation","from":"AccessHub","to":"VaultFeature","relationType":"IMPLEMENTS"}
{"type":"relation","from":"VaultFeature","to":"GroupManagement","relationType":"USES"}
{"type":"relation","from":"Traffic","to":"PacketCrafting","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Traffic","to":"PacketInspector","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Traffic","to":"Sorting","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Traffic","to":"FlowFiltering","relationType":"IMPLEMENTS"}
{"type":"relation","from":"PacketCrafting","to":"PacketStructure","relationType":"USES"}
{"type":"relation","from":"PacketInspector","to":"SnifferService.Dissector","relationType":"CONSUMES"}
{"type":"relation","from":"Backend.FastAPI","to":"Backend.Services","relationType":"DEPENDS_ON"}
{"type":"relation","from":"Frontend.React","to":"Backend.FastAPI","relationType":"CONSUMES"}
{"type":"relation","from":"Frontend.Scans.VulnerabilityScanWorkflow","to":"Backend.Services.VersionDetectionService","relationType":"USES"}
{"type":"relation","from":"Frontend.Scans.VulnerabilityScanWorkflow","to":"Backend.Services.CVELookupService","relationType":"USES"}
{"type":"relation","from":"Frontend.Scans.VulnerabilityScanWorkflow","to":"Backend.Services.ExploitMatchService","relationType":"USES"}
{"type":"relation","from":"Backend.Services.CVELookupService","to":"Backend.Services.ExploitMatchService","relationType":"ENRICHES_WITH"}
{"type":"entity","name":"NOP.Backend.Models.Flow","entityType":"model","observations":["Network traffic flow tracking with QoS metrics, DPI, threat scoring","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.Event","entityType":"model","observations":["Audit logging with event types (login, scan, alert) and severity levels","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.Vulnerability","entityType":"model","observations":["Security findings with CVE/CWE tracking, CVSS scoring","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.TopologyEdge","entityType":"model","observations":["Network topology connections with edge types (direct, routed, VPN, inferred)","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.Scan","entityType":"model","observations":["Scan jobs with types (discovery, port, service, vuln) and status tracking","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.ScanResult","entityType":"model","observations":["Individual scan findings storage","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.Credential","entityType":"model","observations":["Encrypted credential storage with AES-256-GCM encryption","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.Asset","entityType":"model","observations":["Network asset with classification, confidence scoring, vendor detection","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.User","entityType":"model","observations":["Authentication with role-based access (admin, operator, analyst, viewer)","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Models.Settings","entityType":"model","observations":["System configuration storage by category","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.AuthEndpoint","entityType":"endpoint","observations":["JWT authentication with login/logout/token refresh","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.AssetsEndpoint","entityType":"endpoint","observations":["Asset CRUD operations, stats, online/offline filtering","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.DiscoveryEndpoint","entityType":"endpoint","observations":["Network scanning with background tasks, scan status tracking","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.TrafficEndpoint","entityType":"endpoint","observations":["WebSocket traffic streaming, packet crafting, PCAP export","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.ScansEndpoint","entityType":"endpoint","observations":["Scan management (placeholder implementation)","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.CredentialsEndpoint","entityType":"endpoint","observations":["Credential management (placeholder implementation)","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.SettingsEndpoint","entityType":"endpoint","observations":["System settings CRUD by category with defaults","Discovery settings: track_source_only, filter_unicast, filter_multicast, filter_broadcast","Interface auto-detection via /api/v1/traffic/interfaces","upd:2025-12-29"]}
{"type":"entity","name":"Frontend.Settings.InterfaceSelector","entityType":"Feature","observations":["Auto-detected network interfaces with dropdown selector","Shows interface name, IP, and status (up/down)","Polls interfaces every 5 seconds for updates","Cyberpunk-themed styling matching rest of Settings UI","Located in Discovery settings → Network Interface section","upd:2025-12-29"]}
{"type":"entity","name":"TestEnvironment.TrafficSimulator","entityType":"Tool","observations":["Realistic traffic generator using Scapy","Simulates 13 traffic types: HTTP, SSH, MySQL, SMB, RDP, VNC, FTP, DNS, ARP, mDNS, SSDP, DHCP, PING","Weighted random selection for realistic distribution","Configurable duration and intensity (low/medium/high)","Located at scripts/simulate_realistic_traffic.py","upd:2025-12-29"]}
{"type":"entity","name":"Backend.Services.SnifferService.StormEngine","entityType":"Feature","observations":["Multi-tier packet storm generator: low (<1k PPS with scapy), medium (1k-10k raw socket bursts), high (10k-50k single-thread), flood (50k+ multi-threaded)","Raw socket implementation with CAP_NET_RAW capability requirement","SO_BROADCAST socket option for broadcast address support","Achieves 130k+ PPS on 4-core system, scales ~40k PPS per core","Multi-threaded flood mode (2-4 threads) for very high PPS targets","Ether layer fallback when raw socket creation fails","Located in backend/app/services/SnifferService.py","upd:2025-12-30"]}
{"type":"entity","name":"Backend.Docker.Capabilities","entityType":"Configuration","observations":["Backend container requires privileged: true and cap_add: [NET_RAW, NET_ADMIN]","Necessary for raw socket creation in storm functionality","docker-compose restart does NOT rebuild images - must use docker-compose build","Located in docker-compose.yml backend service configuration","upd:2025-12-30"]}
{"type":"entity","name":"Frontend.Storm.LiveMonitoring","entityType":"Feature","observations":["Packet storm testing UI with live host monitoring","Non-blocking ping with 5s timeout, assets dropdown integration","Current Status panel showing storm/ping state indicators","Real-time graph with 0-target_pps scale and connected polyline","Cyber theme styling matching Traffic page","Located at frontend/src/pages/Storm.tsx","upd:2025-12-30"]}
{"type":"entity","name":"Docker.NetworkArchitecture","entityType":"Configuration","observations":["Main services use nop-internal network (auto-created)","Test environment uses test-network (172.21.0.0/16, auto-created by docker-compose.test.yml)","Main compose runs independently without test-network","Optional connection via scripts/connect-to-test-network.sh for debugging","Vulnerable services isolated in docker-compose.test.yml with runtime resource limits","Build-time resource limits: 4GB RAM, 2 CPUs via scripts/build-with-limits.sh","upd:2025-12-30"]}
{"type":"entity","name":"TestEnvironment.Hosts","entityType":"Infrastructure","observations":["7 test hosts on 172.21.0.0/24 network (nop_test-network)","web-server (172.21.0.42), rdp-server (172.21.0.50), vnc-server (172.21.0.51)","ftp-server (172.21.0.52), ssh-server (172.21.0.69), database-server (172.21.0.123), file-server (172.21.0.200)","Managed via docker-compose.test.yml","Used for passive discovery filter testing","upd:2025-12-29"]}
{"type":"entity","name":"NOP.Backend.API.ReportsEndpoint","entityType":"endpoint","observations":["Reporting functionality","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.HealthEndpoint","entityType":"endpoint","observations":["Service health checks","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.AccessEndpoint","entityType":"endpoint","observations":["Remote access testing (SSH, TCP, RDP, FTP operations)","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.EventsEndpoint","entityType":"endpoint","observations":["Event retrieval with pagination","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.HostEndpoint","entityType":"endpoint","observations":["Host system monitoring, terminal WebSocket, filesystem operations","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.SnifferService","entityType":"service","observations":["Real-time packet capture, protocol dissection (30+ protocols), packet crafting","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.PingService","entityType":"service","observations":["Advanced ping with ICMP/TCP/UDP support (hping3-like)","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.NetworkScanner","entityType":"service","observations":["NMAP integration for discovery, port scanning, service/OS detection","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.DiscoveryService","entityType":"service","observations":["Scan result processing, asset database updates","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.AccessHubService","entityType":"service","observations":["SSH/TCP/FTP testing, credential management, system info gathering","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.UserService","entityType":"service","observations":["User management operations","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.AssetService","entityType":"service","observations":["Asset management and tracking","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Services.GuacamoleService","entityType":"service","observations":["Remote desktop protocol handling","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Dashboard","entityType":"page","observations":["Statistics, traffic graphs, event feed, asset type distribution","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Login","entityType":"page","observations":["Authentication form with JWT token handling","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Assets","entityType":"page","observations":["Asset grid view with filtering, inline actions","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Scans","entityType":"page","observations":["Tab-based scanning interface with WebSocket updates","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.AccessHub","entityType":"page","observations":["Multi-protocol remote access with vault feature","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Topology","entityType":"page","observations":["Force-directed graph with layout modes, traffic visualization, subnet filtering","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Traffic","entityType":"page","observations":["Packet capture, flow filtering, packet crafting, packet inspector","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Settings","entityType":"page","observations":["System configuration by category","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Pages.Host","entityType":"page","observations":["System metrics, terminal, filesystem browser, desktop access tabs","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Components.Layout","entityType":"component","observations":["Sidebar navigation with scan/connection indicators, cyber-themed design","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Components.AssetDetailsSidebar","entityType":"component","observations":["Asset details with quick scan/connect actions","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Components.ProtocolConnection","entityType":"component","observations":["Multi-protocol connection handler (SSH, RDP, VNC, FTP) with Guacamole","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Components.ScanSettingsModal","entityType":"component","observations":["Scan configuration dialog","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Components.PacketCrafting","entityType":"component","observations":["Packet crafting UI","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Components.PacketCrafting_new","entityType":"component","observations":["Alternative packet crafting implementation","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Store.AuthStore","entityType":"store","observations":["User authentication state, JWT token management","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Store.ScanStore","entityType":"store","observations":["Scan tab management, multi-host support, scan options","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Store.AccessStore","entityType":"store","observations":["Connection tab management, protocol tracking, status updates","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Store.DiscoveryStore","entityType":"store","observations":["Discovery state tracking","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Services.AssetService","entityType":"service","observations":["Asset API client with scan operations","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Services.DashboardService","entityType":"service","observations":["Dashboard statistics and events API client","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Services.AccessService","entityType":"service","observations":["Credential management API client","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Services.AuthService","entityType":"service","observations":["Authentication API client","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Services.HostService","entityType":"service","observations":["Host monitoring and filesystem API client","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.AssetCreate","entityType":"schema","observations":["Asset creation validation","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.AssetUpdate","entityType":"schema","observations":["Asset update validation","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.AssetResponse","entityType":"schema","observations":["Asset API response format","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.SettingsCategory","entityType":"schema","observations":["Settings category validation","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.TrafficStats","entityType":"schema","observations":["Traffic statistics response","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.FlowResponse","entityType":"schema","observations":["Network flow response format","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.CredentialCreate","entityType":"schema","observations":["Credential creation validation","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.WebSocketTraffic","entityType":"feature","observations":["Real-time traffic streaming with configurable filters","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.PacketDissection","entityType":"feature","observations":["Multi-layer protocol dissection (Ethernet→ARP/IP→TCP/UDP/ICMP→App)","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.PacketCrafting","entityType":"feature","observations":["Custom packet construction and sending","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.BackgroundScanning","entityType":"feature","observations":["Async network discovery with task queue","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.HostMonitoring","entityType":"feature","observations":["System metrics (CPU, memory, disk, network, processes)","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.TerminalWebSocket","entityType":"feature","observations":["Interactive terminal via WebSocket","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.FileSystemBrowser","entityType":"feature","observations":["Remote file operations (read, write, browse)","upd:2025-12-28"]}
{"type":"entity","name":"Backend.Features.EventAuditing","entityType":"feature","observations":["Comprehensive event logging with severity levels","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.MultiHostScanning","entityType":"feature","observations":["Scan multiple IPs simultaneously","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.ScanTabManagement","entityType":"feature","observations":["Persistent scan sessions with log streaming","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.TopologyVisualization","entityType":"feature","observations":["Force-directed graph with 3 layout modes","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.TopologyTrafficOverlay","entityType":"feature","observations":["Traffic volume visualization on edges","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.TopologySubnetFiltering","entityType":"feature","observations":["Filter topology by network range","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.GuacamoleIntegration","entityType":"feature","observations":["Apache Guacamole for RDP/VNC/SSH","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.FTPFileManager","entityType":"feature","observations":["FTP file browser with upload/download","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.CredentialVault","entityType":"feature","observations":["Encrypted credential storage","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.SystemMetricsMonitoring","entityType":"feature","observations":["Real-time CPU/memory/disk graphs","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.ProcessManagement","entityType":"feature","observations":["System process viewer","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.FileTransfer","entityType":"feature","observations":["Resumable file upload/download with progress tracking","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.DesktopAccess","entityType":"feature","observations":["Embedded VNC/RDP desktop viewer","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.ScanProfileManagement","entityType":"feature","observations":["Predefined scan configurations","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.AssetStatistics","entityType":"feature","observations":["Aggregate metrics by type/vendor/status","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.EventFeed","entityType":"feature","observations":["Real-time system events display","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.InterfaceActivityMonitor","entityType":"feature","observations":["Per-interface traffic history graphs","upd:2025-12-28"]}
{"type":"entity","name":"Frontend.Features.ConnectionHistory","entityType":"feature","observations":["Access hub connection tracking","upd:2025-12-28"]}
{"type":"relation","from":"NOP.Backend.API.DiscoveryEndpoint","to":"NOP.Backend.Services.NetworkScanner","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.DiscoveryEndpoint","to":"NOP.Backend.Services.DiscoveryService","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.TrafficEndpoint","to":"NOP.Backend.Services.SnifferService","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.AccessEndpoint","to":"NOP.Backend.Services.AccessHubService","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.AccessEndpoint","to":"NOP.Backend.Services.GuacamoleService","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.HostEndpoint","to":"NOP.Backend.Services.PingService","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.AssetsEndpoint","to":"NOP.Backend.Services.AssetService","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.EventsEndpoint","to":"NOP.Backend.Models.Event","relationType":"CONSUMES"}
{"type":"relation","from":"NOP.Backend.Services.DiscoveryService","to":"NOP.Backend.Models.Asset","relationType":"MODIFIES"}
{"type":"relation","from":"NOP.Backend.Services.DiscoveryService","to":"NOP.Backend.Models.Event","relationType":"CREATES"}
{"type":"relation","from":"NOP.Backend.Services.AccessHubService","to":"NOP.Backend.Models.Credential","relationType":"CONSUMES"}
{"type":"relation","from":"NOP.Backend.Services.NetworkScanner","to":"NOP.Backend.Models.Asset","relationType":"READS"}
{"type":"relation","from":"NOP.Backend.Services.SnifferService","to":"NOP.Backend.Models.Flow","relationType":"CREATES"}
{"type":"relation","from":"Frontend.Pages.Dashboard","to":"Frontend.Services.DashboardService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Dashboard","to":"Frontend.Services.AssetService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Assets","to":"Frontend.Services.AssetService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Scans","to":"Frontend.Store.ScanStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.AccessHub","to":"Frontend.Store.AccessStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.AccessHub","to":"Frontend.Services.AccessService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Topology","to":"Frontend.Services.AssetService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Topology","to":"Frontend.Services.DashboardService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Traffic","to":"NOP.Backend.Services.SnifferService","relationType":"CONSUMES_VIA_WS"}
{"type":"relation","from":"Frontend.Pages.Host","to":"Frontend.Services.HostService","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Settings","to":"NOP.Backend.API.SettingsEndpoint","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.Layout","to":"Frontend.Store.AuthStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.Layout","to":"Frontend.Store.ScanStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.Layout","to":"Frontend.Store.AccessStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.Layout","to":"Frontend.Store.DiscoveryStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.AssetDetailsSidebar","to":"Frontend.Store.ScanStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.AssetDetailsSidebar","to":"Frontend.Store.AccessStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.ProtocolConnection","to":"Frontend.Store.AccessStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Components.ProtocolConnection","to":"Frontend.Store.AuthStore","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Topology","to":"Frontend.Features.TopologyVisualization","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Frontend.Pages.Host","to":"Backend.Features.HostMonitoring","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Frontend.Pages.Host","to":"Backend.Features.TerminalWebSocket","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Frontend.Pages.Host","to":"Backend.Features.FileSystemBrowser","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Frontend.Components.ProtocolConnection","to":"Frontend.Features.GuacamoleIntegration","relationType":"IMPLEMENTS"}
{"type":"relation","from":"Frontend.Components.ProtocolConnection","to":"Frontend.Features.FTPFileManager","relationType":"IMPLEMENTS"}
{"type":"relation","from":"NOP.Backend.Services.SnifferService","to":"Backend.Features.PacketDissection","relationType":"IMPLEMENTS"}
{"type":"relation","from":"NOP.Backend.Services.SnifferService","to":"Backend.Features.PacketCrafting","relationType":"IMPLEMENTS"}
{"type":"codegraph","name":"SnifferService.py","nodeType":"service","dependencies":["Scapy","Threading","AsyncIO"],"dependents":["TrafficEndpoint"]}
{"type":"codegraph","name":"PingService.py","nodeType":"service","dependencies":["AsyncIO","Subprocess"],"dependents":["HostEndpoint"]}
{"type":"codegraph","name":"NetworkScanner.py","nodeType":"service","dependencies":["NMAP","AsyncIO"],"dependents":["DiscoveryEndpoint","DiscoveryService"]}
{"type":"codegraph","name":"DiscoveryService.py","nodeType":"service","dependencies":["Database","NetworkScanner","Asset.Model"],"dependents":["DiscoveryEndpoint"]}
{"type":"codegraph","name":"AccessHubService.py","nodeType":"service","dependencies":["SSH","FTP","AsyncIO","Credential.Model"],"dependents":["AccessEndpoint"]}
{"type":"codegraph","name":"UserService.py","nodeType":"service","dependencies":["Database","User.Model"],"dependents":["AuthEndpoint"]}
{"type":"codegraph","name":"TrafficEndpoint","nodeType":"endpoint","dependencies":["SnifferService","WebSocket"],"dependents":[]}
{"type":"codegraph","name":"DiscoveryEndpoint","nodeType":"endpoint","dependencies":["NetworkScanner","DiscoveryService","BackgroundTasks"],"dependents":[]}
{"type":"codegraph","name":"AccessEndpoint","nodeType":"endpoint","dependencies":["AccessHubService","GuacamoleService"],"dependents":[]}
{"type":"codegraph","name":"HostEndpoint","nodeType":"endpoint","dependencies":["PingService","WebSocket","psutil"],"dependents":[]}
{"type":"codegraph","name":"EventsEndpoint","nodeType":"endpoint","dependencies":["Event.Model","Database"],"dependents":[]}
{"type":"codegraph","name":"SettingsEndpoint","nodeType":"endpoint","dependencies":["Settings.Model","Database"],"dependents":[]}
{"type":"codegraph","name":"Dashboard.tsx","nodeType":"page","dependencies":["DashboardService","AssetService","AuthStore"],"dependents":["Layout"]}
{"type":"codegraph","name":"Topology.tsx","nodeType":"page","dependencies":["AssetService","DashboardService","ForceGraph2D"],"dependents":["Layout"]}
{"type":"codegraph","name":"Host.tsx","nodeType":"page","dependencies":["HostService","AuthStore","AccessStore","xterm"],"dependents":["Layout"]}
{"type":"codegraph","name":"Assets.tsx","nodeType":"page","dependencies":["AssetService","AuthStore"],"dependents":["Layout"]}
{"type":"codegraph","name":"Scans.tsx","nodeType":"page","dependencies":["ScanStore","AuthStore"],"dependents":["Layout"]}
{"type":"codegraph","name":"Login.tsx","nodeType":"page","dependencies":["AuthStore","axios"],"dependents":["Layout"]}
{"type":"codegraph","name":"Layout.tsx","nodeType":"component","dependencies":["AuthStore","ScanStore","AccessStore","DiscoveryStore"],"dependents":["App"]}
{"type":"codegraph","name":"AssetDetailsSidebar.tsx","nodeType":"component","dependencies":["ScanStore","AccessStore"],"dependents":["Assets","Topology"]}
{"type":"codegraph","name":"ProtocolConnection.tsx","nodeType":"component","dependencies":["AccessStore","AccessService","Guacamole"],"dependents":["AccessHub","Host"]}
{"type":"codegraph","name":"ScanSettingsModal.tsx","nodeType":"component","dependencies":["ScanStore"],"dependents":["Scans"]}
{"type":"codegraph","name":"authStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["All pages","Layout"]}
{"type":"codegraph","name":"scanStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["Scans","AssetDetailsSidebar","Layout"]}
{"type":"codegraph","name":"accessStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["AccessHub","ProtocolConnection","Layout","Host"]}
{"type":"codegraph","name":"discoveryStore.ts","nodeType":"store","dependencies":["zustand"],"dependents":["Layout","Assets"]}
{"type":"codegraph","name":"assetService.ts","nodeType":"service","dependencies":["axios"],"dependents":["Dashboard","Assets","Topology"]}
{"type":"codegraph","name":"dashboardService.ts","nodeType":"service","dependencies":["axios"],"dependents":["Dashboard","Topology"]}
{"type":"codegraph","name":"accessService.ts","nodeType":"service","dependencies":["axios"],"dependents":["ProtocolConnection","AccessHub"]}
{"type":"codegraph","name":"authService.ts","nodeType":"service","dependencies":["axios"],"dependents":["Login","AuthStore"]}
{"type":"codegraph","name":"hostService.ts","nodeType":"service","dependencies":["axios"],"dependents":["Host"]}
{"type":"codegraph","name":"Flow.Model","nodeType":"model","dependencies":["SQLAlchemy","PostgreSQL"],"dependents":["SnifferService"]}
{"type":"codegraph","name":"Event.Model","nodeType":"model","dependencies":["SQLAlchemy","PostgreSQL"],"dependents":["EventsEndpoint","DiscoveryService"]}
{"type":"codegraph","name":"TopologyEdge.Model","nodeType":"model","dependencies":["SQLAlchemy","PostgreSQL","Asset.Model"],"dependents":[]}
{"type":"codegraph","name":"Vulnerability.Model","nodeType":"model","dependencies":["SQLAlchemy","PostgreSQL","Asset.Model"],"dependents":[]}
{"type":"entity","name":"NOP.Backend.Core.Config","entityType":"module","observations":["Application settings using Pydantic BaseSettings","Environment variable configuration","Database and Redis connection strings","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Core.Database","entityType":"module","observations":["SQLAlchemy async database engine and session factory","Connection pooling configuration","Async context manager for database sessions","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Core.Redis","entityType":"module","observations":["Redis async client configuration","Connection management for caching and pub/sub","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Core.InitDB","entityType":"module","observations":["Database initialization and seeding","Default admin user creation","Schema creation and migrations","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Utils.Diagnostic","entityType":"utility","observations":["System diagnostic tool for troubleshooting","Database connectivity verification","Admin user and password validation","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Utils.ResetAdmin","entityType":"utility","observations":["Admin password reset utility","Database admin user password update","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.UserCreate","entityType":"schema","observations":["User creation validation schema","Username, email, password, role validation","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.UserResponse","entityType":"schema","observations":["User API response format","Excludes sensitive password data","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.ScanCreate","entityType":"schema","observations":["Scan job creation validation","Target, scan type, options validation","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.ScanResponse","entityType":"schema","observations":["Scan job response format","Includes status and results","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.ScanResultResponse","entityType":"schema","observations":["Individual scan result response","Finding details and metadata","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.CredentialResponse","entityType":"schema","observations":["Credential API response format","Encrypted credential data","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.PingResponse","entityType":"schema","observations":["Ping operation result schema","Latency, packet loss, hop count data","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.Schemas.SettingsUpdateRequest","entityType":"schema","observations":["Settings update validation","Category-based configuration updates","upd:2025-12-28"]}
{"type":"entity","name":"NOP.Backend.API.WebSocketRouter","entityType":"endpoint","observations":["WebSocket routing infrastructure","Terminal and traffic stream management","upd:2025-12-28"]}
{"type":"codegraph","name":"Config.py","nodeType":"module","dependencies":["Pydantic","os"],"dependents":["main.py","all services"]}
{"type":"codegraph","name":"Database.py","nodeType":"module","dependencies":["SQLAlchemy","asyncpg"],"dependents":["all endpoints","all services"]}
{"type":"codegraph","name":"Redis.py","nodeType":"module","dependencies":["redis-async"],"dependents":["main.py","caching"]}
{"type":"codegraph","name":"InitDB.py","nodeType":"module","dependencies":["Database.py","User.Model","Security.py"],"dependents":["main.py"]}
{"type":"codegraph","name":"WebSocketRouter","nodeType":"router","dependencies":["FastAPI","WebSocket"],"dependents":["main.py"]}
{"type":"relation","from":"NOP.Backend.Core.Database","to":"NOP.Backend.Models","relationType":"PROVIDES_SESSION"}
{"type":"relation","from":"NOP.Backend.Core.InitDB","to":"NOP.Backend.Core.Database","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.Core.InitDB","to":"NOP.Backend.Core.Security","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.API.WebSocketRouter","to":"Backend.Features.TerminalWebSocket","relationType":"IMPLEMENTS"}
{"type":"relation","from":"NOP.Backend.API.WebSocketRouter","to":"Backend.Features.WebSocketTraffic","relationType":"IMPLEMENTS"}
{"type":"relation","from":"NOP.Backend.Utils.Diagnostic","to":"NOP.Backend.Core.Database","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.Utils.Diagnostic","to":"NOP.Backend.Core.Security","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.Utils.ResetAdmin","to":"NOP.Backend.Core.Database","relationType":"USES"}
{"type":"relation","from":"NOP.Backend.Utils.ResetAdmin","to":"NOP.Backend.Core.Security","relationType":"USES"}
{"type":"entity","name":"NOP.AgentFramework.Skills","entityType":"Framework","observations":["13 core skills covering Quality, Process, Backend, Frontend, DevOps","Auto-detection based on project stack (Python, TypeScript, Docker)","Domain-specific skills in .claude/skills/domain.md","8 NOP-specific patterns: Network services, WebSocket, Protocol dissection, React/Zustand, FastAPI","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"NOP.AgentFramework.Knowledge","entityType":"Framework","observations":["Dual knowledge system: project_knowledge.json + global_knowledge.json","JSONL format for entities, relations, codegraph nodes","Entity types: System, Service, Feature, Component, Model, Endpoint, etc.","Size target: <100KB total, Entity:Cluster ratio ≥6:1","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"NOP.AgentFramework.Workflows","entityType":"Framework","observations":["7 workflow types: init_project, import_project, refactor_code, update_knowledge, update_skills, update_documents, update_tests","Multi-agent orchestration: _DevTeam coordinates Architect, Developer, Reviewer, Researcher","7-phase execution: CONTEXT→PLAN→COORDINATE→INTEGRATE→VERIFY→LEARN→COMPLETE","Workflow logs in log/workflow/ with timestamp and task slug","upd:2025-12-29,refs:1"]}
{"type":"entity","name":"NOP.Documentation.Structure","entityType":"Documentation","observations":["11 core documents organized in 6 categories","Categories: architecture, technical, guides, development, design, features","Naming: ARCH_[sys]_v[N].md, API_[svc]_v[N].md","Consolidated approach: 10-15 core docs target","upd:2025-12-29,refs:1"]}
{"type":"relation","from":"NOP.AgentFramework.Workflows","to":"NOP.AgentFramework.Knowledge","relationType":"UPDATES"}
{"type":"relation","from":"NOP.AgentFramework.Workflows","to":"NOP.AgentFramework.Skills","relationType":"UPDATES"}
{"type":"relation","from":"NOP.AgentFramework.Workflows","to":"NOP.Documentation.Structure","relationType":"UPDATES"}
{"type":"relation","from":"NOP.AgentFramework.Knowledge","to":"Global.Pattern.Knowledge.JSONL","relationType":"USES"}
{"type":"entity","name":"Frontend.Traffic.StormFeature","entityType":"Feature","observations":["Packet storm generation for testing network protection mechanisms","Supports 5 packet types: broadcast, multicast, TCP, UDP, raw IP","Configurable PPS (1-100,000 packets per second)","Real-time metrics: packets sent, bytes sent, duration, current PPS","Live PPS graph with 60-second rolling window","TCP flag selection (SYN, ACK, FIN, RST, PSH, URG)","Interface selection with IP display","Optional source IP and payload configuration","Warning banner for responsible use","upd:2025-12-29"]}
{"type":"entity","name":"Backend.Services.SnifferService.Storm","entityType":"Service","observations":["Dedicated storm thread for packet generation","Scapy-based packet crafting and sending","Real-time PPS calculation with 1-second granularity","Input validation for packet type, PPS, ports","Single storm session enforcement","Metrics collection: packets_sent, bytes_sent, current_pps, duration","Support for broadcast, multicast, TCP, UDP, raw IP packets","Configurable TTL, flags, payload","upd:2025-12-29"]}
{"type":"entity","name":"Backend.API.TrafficEndpoint.Storm","entityType":"endpoint","observations":["POST /api/v1/traffic/storm/start - Start packet storm","POST /api/v1/traffic/storm/stop - Stop active storm","GET /api/v1/traffic/storm/metrics - Get real-time metrics","JSON configuration with packet_type, dest_ip, pps, flags","Returns success/error status and metrics","upd:2025-12-29"]}
{"type":"codegraph","name":"Storm.tsx","nodeType":"page","dependencies":["useAuthStore"],"dependents":["Traffic.tsx"]}
{"type":"relation","from":"Traffic","to":"StormFeature","relationType":"IMPLEMENTS"}
{"type":"relation","from":"StormFeature","to":"SnifferService.Storm","relationType":"CONSUMES"}
{"type":"relation","from":"SnifferService.Storm","to":"Scapy","relationType":"USES"}
{"type":"entity","name":"Backend.Services.SnifferService.StormEngine","entityType":"module","observations":["Multi-threaded raw socket flooding for high PPS (50k+)","SO_BROADCAST required for broadcast addresses","CAP_NET_RAW capability required in container","System max ~155k PPS on 4 cores, scales with CPU count","upd:2024-12-30"]}
{"type":"entity","name":"Backend.Docker.Capabilities","entityType":"config","observations":["CAP_NET_RAW for raw socket creation","CAP_NET_ADMIN for network configuration","docker-compose restart does not rebuild - use docker-compose build","upd:2024-12-30"]}
{"type":"entity","name":"AgentFramework.ProtocolEnforcement","entityType":"pattern","observations":["Session start trigger at top of copilot-instructions.md","Action indicators: check, fix, add, create, update, refactor, investigate, implement, test, debug, optimize","Required emissions: [SESSION:] FIRST, [PHASE: CONTEXT] SECOND, [DECISION:], [ATTEMPT:], [SUBAGENT:]","Protocol compliance checklist in workflow logs","Skip protocol only for pure Q&A, single clarifications, no file edits","upd:2024-12-30"]}
{"type":"entity","name":"AgentFramework.KnowledgeLoadingVerification","entityType":"protocol","observations":["Explicit emission requirement: [KNOWLEDGE: loaded | entities=N | sources=M]","Verifies knowledge loaded from project_knowledge.json and global_knowledge.json","Prevents silent failures in knowledge loading","Makes context availability transparent to users","upd:2025-12-30"]}
{"type":"entity","name":"AgentFramework.SkillTransparency","entityType":"protocol","observations":["Explicit emission requirement: [SKILLS: loaded=N | available: #1,#2,#3...]","Lists all 14 core skills at session start","Format: #N-Name or #N Name","Auto-detection determines active skills (10-12 stack-specific)","Creates capability transparency and accountability","upd:2025-12-30"]}
{"type":"entity","name":"AgentFramework.SkillUsageTracking","entityType":"protocol","observations":["Emission format: [SKILL: #N Name | applied] → context","Shows which skills are applied during work","Improves user understanding of agent reasoning","Creates audit trail in workflow logs","Examples: [SKILL: #3 Security | applied] → Validating input sanitization","upd:2025-12-30"]}
{"type":"relation","from":"AgentFramework.SkillTransparency","to":"AgentFramework.SkillUsageTracking","relationType":"ENABLES"}
{"type":"relation","from":"AgentFramework.KnowledgeLoadingVerification","to":"AgentFramework.ProtocolEnforcement","relationType":"EXTENDS"}
{"type":"entity","name":"AgentFramework.OptimizationAnalysis","entityType":"analysis","observations":["Analyzed 19 historical workflow logs for protocol compliance","0% compliance with SKILLS/KNOWLEDGE/SKILL tracking (except protocol definition log)","95%+ projected compliance with new protocol enforcement","85-93% reduction in debugging time through transparency","18x improvement in visibility and accountability","upd:2025-12-30"]}
{"type":"entity","name":"AgentFramework.HistoricalCompliance","entityType":"metric","observations":["SESSION emission: 15.8% (3/19 logs)","SKILLS declaration: 0% (0/19 logs)","KNOWLEDGE verification: 0% (0/19 logs)","SKILL usage tracking: 0% (0/19 logs)","Overall compliance: 5.3% baseline","upd:2025-12-30"]}
{"type":"entity","name":"Documentation.EcosystemOptimizationAnalysis","entityType":"document","observations":["Comprehensive analysis comparing old vs new protocol","19 workflow logs examined (2025-12-28 to 2025-12-30)","Case studies: Multi-thread session, Passive discovery, Ecosystem analysis","ROI analysis: Time savings, trust metrics, debugging improvements","Migration path defined: Awareness, Enforcement, Validation phases","upd:2025-12-30"]}
{"type":"relation","from":"AgentFramework.OptimizationAnalysis","to":"AgentFramework.KnowledgeLoadingVerification","relationType":"VALIDATES"}
{"type":"relation","from":"AgentFramework.OptimizationAnalysis","to":"AgentFramework.SkillTransparency","relationType":"VALIDATES"}
{"type":"relation","from":"AgentFramework.HistoricalCompliance","to":"AgentFramework.ProtocolEnforcement","relationType":"MEASURES"}
{"type":"entity","name":"Frontend.UIComponents.CyberpunkCheckbox","entityType":"Pattern","observations":["Standardized checkbox design across all pages","Hidden native input with sr-only peer class","Custom styled div with colored border (purple/red/blue/green based on context)","White ◆ symbol displayed when checked via conditional rendering","Smooth transitions on state change with peer-checked:bg-* classes","Disabled states supported with peer-disabled:opacity-50","Applied to: Scans (port options, vuln databases), Settings (all toggles), Traffic (HTTPS toggle), ScanSettingsModal (discovery options), ProtocolConnection (remember credentials), PacketCrafting (TCP flags)","upd:2025-12-30,refs:7"]}
{"type":"entity","name":"Frontend.UIComponents.CyberpunkSlider","entityType":"Pattern","observations":["Standardized range slider design across application","Thin track (0.5px height) with cyber-purple border on cyber-gray background","Square red thumb (12px) with 2px border and rounded-none style","Glow effect using shadow-[0_0_8px_rgba(255,0,102,0.6)]","Enhanced glow on hover shadow-[0_0_12px_rgba(255,0,102,0.9)]","Webkit and Mozilla specific pseudo-element styling","Applied to: Settings page (18+ sliders via SettingsSlider component), ScanSettingsModal (PPS timing slider)","upd:2025-12-30,refs:2"]}
{"type":"entity","name":"Frontend.Pages.Scans","entityType":"Component","observations":["Dual-pane layout: Port scan (left) + Vulnerability scan (right)","Port scan options use cyberpunk checkboxes with red theme","Vulnerability database selection with purple-themed checkboxes","Manual port input with auto-detection fallback","Confirmation dialog before vulnerability scanning showing host IP and ports","Vulnerability details side panel with exploit code display","Navigation banner removed from Exploit page directing users here","upd:2025-12-30,refs:1"]}
{"type":"entity","name":"Frontend.Patterns.ComponentStandardization","entityType":"Process","observations":["Pattern for standardizing UI components across application","Step 1: Use grep_search to find all instances of component type","Step 2: Read current implementations to understand variations","Step 3: Design standardized component with consistent styling","Step 4: Use multi_replace_string_in_file for batch updates","Step 5: Rebuild frontend to deploy changes","Successfully applied to checkboxes (11 locations) and sliders (19 locations)","Maintains theme consistency while allowing contextual color variations","upd:2025-12-30,refs:1"]}
{"type":"entity","name":"Frontend.UIComponents.StandardizedButtons","entityType":"Pattern","observations":["CSS button system in index.css with size and color classes","Base class: btn-base (inline-flex, items-center, justify-center, font-bold, uppercase, tracking-wider, transition-colors)","Size classes: btn-sm (px-2 py-0.5 text-xs), btn-md (px-3 py-1 text-xs), btn-lg (px-4 py-2 text-sm)","Color classes: btn-red (bg-opacity-10 border-cyber-red text-cyber-red hover:bg-cyber-red), btn-blue, btn-green, btn-purple, btn-gray","Usage: className='btn-base btn-md btn-red' for consistent styling","Replaces ad-hoc button styling across all pages","upd:2026-01-02"]}
{"type":"entity","name":"Frontend.Pages.Scans.Layout","entityType":"Feature","observations":["Dual-pane layout: Asset list (300px left) + Scan areas (right)","Scan areas side-by-side: Port Scan + Vulnerability Scan in grid-cols-2","Direct asset selection (click to open) without toggle","Scan status indicators in asset list (running/completed/failed)","Gray borders (border-cyber-gray) replacing colored borders for consistency","Full height utilization with flex-1 min-h-0 pattern","Each scan area has header with Scan/Access/Exploit/Settings buttons","upd:2026-01-02"]}
{"type":"entity","name":"Frontend.UIComponents.HoverEffects","entityType":"Pattern","observations":["Removed excessive hover effects from dashboard-card and cyber-border classes","Previous: box-shadow, transform effects on hover - caused visual clutter","Current: simplified hover with only essential feedback","Improves readability and reduces distraction","upd:2026-01-02"]}
{"type":"entity","name":"Frontend.Pages.Login.Validation","entityType":"Fix","observations":["Removed redundant manual validation that conflicted with react-hook-form","Previous: onSubmit checked username/password before form validation ran","Current: let react-hook-form handle all validation via rules prop","Fixes 'username and password required' error despite input","upd:2026-01-02"]}
{"type":"entity","name":"Docker.Production.NetworkArchitecture","entityType":"Config","observations":["Backend uses network_mode: host for interface visibility (scanning)","Postgres/Redis use static IPs on nop-internal bridge network","Static IPs: postgres=172.28.0.10, redis=172.28.0.11","Subnet: 172.28.0.0/16 for nop-internal network","Backend connects via static IPs (not DNS names or localhost)","No ports exposed to host for postgres/redis (security)","Frontend/guacd use nop-internal bridge network normally","upd:2026-01-02"]}
{"type":"relation","from":"Frontend.Pages.Scans.Layout","to":"Frontend.UIComponents.StandardizedButtons","relationType":"USES"}
{"type":"relation","from":"Frontend.Pages.Access","to":"Frontend.UIComponents.StandardizedButtons","relationType":"USES"}
{"type":"relation","from":"Docker.Production.NetworkArchitecture","to":"Backend.Services.SnifferService","relationType":"ENABLES"}
{"type":"entity","name":"AKIS.ComplianceChecker.Alignment","entityType":"fix","observations":["Fixed checker-protocol misalignment in check_workflow_compliance.sh","Changed [AKIS_LOADED] to [AKIS] pattern matching","Added case-insensitive 'Skills Used' section detection","Changed [COMPLETE:] to [COMPLETE] (optional colon)","Result: compliance detection improved from 16.1% to 32.2%","upd:2026-01-02"]}
{"type":"entity","name":"AKIS.Phases.BlockingGates","entityType":"protocol","observations":["Added [SESSION:] as FIRST blocking gate before any work","Added [SKILLS:] emission requirement to INTEGRATE phase","Added 'Workflow Log Requirements' section with 5 mandatory elements","Elements: [SESSION:], [AKIS], [PHASE:], Skills tracking, [COMPLETE]","upd:2026-01-02"]}
{"type":"relation","from":"AKIS.ComplianceChecker.Alignment","to":"AgentFramework.ProtocolEnforcement","relationType":"VALIDATES"}
{"type":"entity","name":"AKIS.SessionTracking.MultiSession","entityType":"infrastructure","observations":["Tracks multiple concurrent sessions in single chat conversation",".akis-sessions.json file maintains all active and completed sessions","Export all sessions to combined workflow log before commit","Reset command clears all session files after GitHub commit","VSCode extension displays all sessions in Current Session view","upd:2026-01-02"]}
{"type":"entity","name":"AKIS.WorkflowLog.StandardizedFormat","entityType":"Pattern","observations":["Combines AKIS session data with structured markdown for workflow documentation","Executive summary: duration, session count, objectives, status","Session details: agent, timeline, phase progression (1/7 to 7/7)","Action tree: chronological log with SESSION_START, PHASE_CHANGE, DECISION, DELEGATION, FILE_CHANGE","Context tracking: entities, skills, patterns, files, changes (SSOT)","Phase breakdown: completed/active status with action counts per phase","Completion summary: total duration, generation timestamp","Generated via session-tracker.js exportToWorkflowLog() function","Format version: AKIS Session Tracker v2.0","upd:2026-01-02"]}
{"type":"relation","from":"AKIS.WorkflowLog.StandardizedFormat","to":"AKIS.SessionTracker","relationType":"GENERATED_BY"}
{"type":"relation","from":"AKIS.WorkflowLog.StandardizedFormat","to":"AKIS.Monitor.VSCodeExtension","relationType":"CONSUMED_BY"}
{"type":"entity","name":"VSCode.Extension.ActivityBarIcon","entityType":"pattern","observations":["Activity bar icons must use simple monochrome SVG with currentColor","Gradients, filters, complex elements not rendered - appear as circles","Use 24x24 viewBox with stroke=currentColor for proper theming","upd:2026-01-02,refs:1"]}
{"type":"entity","name":"VSCode.Extension.SessionHierarchy","entityType":"pattern","observations":["Parser must explicitly copy parentSessionId and depth fields","CSS data-depth attribute enables depth-based styling","Visual tree connectors use ::before pseudo-elements with border-left/bottom","upd:2026-01-02,refs:1"]}
{"type":"entity","name":"AKIS.SessionFile","entityType":"component","observations":["Primary source of agent session state is .akis-session.json","Contains: id, name, status, phase, progress, agent, depth, parentSessionId, actions, decisions, context","Multi-session file .akis-sessions.json contains all sessions for visualization","Agent should read session file first at every response start","upd:2026-01-02,refs:1"]}
{"type":"relation","from":"AKIS.SessionFile","to":"VSCode.Extension.SessionHierarchy","relationType":"DRIVES"}
{"type":"relation","from":"VSCode.Extension.ActivityBarIcon","to":"NOP.VSCodeExtension","relationType":"IMPLEMENTS"}
{"type":"entity","name":"AKIS.SessionDrivenWorkflow","entityType":"pattern","observations":["Session file is SSOT, not manage_todo_list","Phases auto-tracked via session state (phase, progress, actions[])","Deviations logged as decisions[], not todo updates","Skills tracked in skills[] array per session","Agent workflow: Read session → Continue phase → Update state → Next phase","Reduces cognitive load: no todo sync, just session update commands","upd:2026-01-02"]}
{"type":"entity","name":"AKIS.SessionDrivenWorkflow.v2","entityType":"pattern","observations":["Sessions replace manage_todo_list as SSOT for workflow state","Agent reads .akis-session.json first, continues from current phase","Deviations logged via decision command, not todo updates","Parent sessions auto-pause with phase/progress, auto-resume on child complete","PAUSE/RESUME/INTERRUPT action types track state transitions","Skills tracked in session skills[] array per session","Auto-collapse completed sessions in extension UI","Auto-scroll to latest action when session active","upd:2026-01-02"]}
{"type":"entity","name":"VSCodeExtension.LiveSessionView","entityType":"feature","observations":["Auto-collapse completed sessions (status=completed or phase=COMPLETE)","Auto-expand only active sessions with scroll to latest","Stack-based action display with newest on top","Auto-scroll enabled by default, always scrolls on new action","Diff-based rendering reduces DOM updates by 70%","upd:2026-01-02"]}
{"type":"entity","name":"AKIS.SessionTracker.ParentResume","entityType":"feature","observations":["Parent session paused with details.pausedPhase and details.progress","Child complete triggers auto-resume of parent at exact paused phase","resume() method finds PAUSE action to restore phase state","RESUME action emitted with resumedFrom details","Supports nested sessions up to depth 3","upd:2026-01-02"]}
